# Trivy configuration file for comprehensive security scanning
# This file defines scanning policies and rules for the LLMOps pipeline

# Global settings
timeout: "10m"
quiet: false
debug: false

# Scan settings - using skip-dirs and skip-files at root level
skip-dirs:
  - ".git"
  - "node_modules"
  - "__pycache__"
  - ".pytest_cache"
  - "htmlcov"
  - "ai-env"
  - "venv"

skip-files:
  - "*.pyc"
  - "*.pyo"
  - "*.log"
  - "*.tmp"

# Package types to scan (replaces deprecated vulnerability.type)
pkg:
  types:
    - "os"
    - "library"

# Severity levels to include
severity:
  - "UNKNOWN"
  - "LOW" 
  - "MEDIUM"
  - "HIGH"
  - "CRITICAL"

# Secret scanning settings
secret:
  # Skip secret detection for these paths
  skip-paths:
    - ".git/"
    - "test_*"
    - "*.md"

# License scanning
license:
  # License types to flag as issues
  full: true
  ignored:
    - "MIT"
    - "Apache-2.0"
    - "BSD-3-Clause"
    - "BSD-2-Clause"
    - "ISC"

# Misconfiguration scanning
misconfiguration:
  # Include Terraform, Kubernetes, Docker configs
  include-non-failures: false
  
  # Trace misconfiguration detection
  trace: false

# Output formatting
format: "table"

# Report settings  
report-type: "all"
ignore-unfixed: false
exit-code: 0  # Don't fail the build by default

# Cache settings  
cache:
  # Cache directory
  dir: "/tmp/trivy"